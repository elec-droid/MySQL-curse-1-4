# MySQL Основы реляционных баз данных
Курс GeekBrains. Решение практических заданий по курсу
___
## Оглавление

1. [Вебинар. Установка окружения. DDL - команды](#1-вебинар-установка-окружения-ddl---команды)
2. [Видеоурок. Управление БД. Язык запросов SQL](#2-видеоурок-управление-бд-язык-запросов-sql)
3. [Вебинар. Введение в проектирование БД](#3-вебинар-введение-в-проектирование-бд)
4. [Вебинар. CRUD-операции](#4-вебинар-crud-операции)
5. [Видеоурок. Операторы, фильтрация, сортировка и ограничение. Агрегация данных](#5-видеоурок-операторы-фильтрация-сортировка-и-ограничение-агрегация-данных)
6. [Вебинар. Операторы, фильтрация, сортировка и ограничение. Агрегация данных](#6-вебинар-операторы-фильтрация-сортировка-и-ограничение-агрегация-данных)
7. [Видеоурок. Сложные запросы](#7-видеоурок-сложные-запросы)
8. [Вебинар. Сложные запросы](#8-вебинар-сложные-запросы)
9. [Видеоурок. Транзакции, переменные, представления. Администрирование. Хранимые процедуры и функции, триггеры](#9-видеоурок-транзакции-переменные-представления-администрирование-хранимые-процедуры-и-функции-триггеры)
10. [Вебинар. Транзакции, переменные, представления\. Администрирование. Хранимые процедуры и функции, триггеры](#10-вебинар-транзакции-переменные-представления-администрирование-хранимые-процедуры-и-функции-триггеры)
11. [Видеоурок. Оптимизация запросов. NoSQL](#11-видеоурок-оптимизация-запросов-nosql)
12. [Вебинар. Оптимизация запросов](#12-вебинар-оптимизация-запросов)

____
## 1\. Вебинар\. Установка окружения. DDL - команды

[Вернуться к Оглавлению](#Оглавление)
## 2\. Видеоурок\. Управление БД\. Язык запросов SQL
1. Установите СУБД MySQL. Создайте в домашней директории файл .my.cnf, задав в нем логин и пароль, который указывался при установке.
2. Создайте базу данных `example`, разместите в ней таблицу `users`, состоящую из двух столбцов, числового `id` и строкового `name`.
3. Создайте дамп базы данных `example` из предыдущего задания, разверните содержимое дампа в новую базу данных `sample`.
4. (по желанию) Ознакомьтесь более подробно с документацией утилиты `mysqldump`. Создайте дамп единственной таблицы `help_keyword` базы данных `mysql`. Причем добейтесь того, чтобы дамп содержал только первые 100 строк таблицы.

[Вернуться к Оглавлению](#Оглавление)
## 3\. Вебинар\. Введение в проектирование БД
1. Создать структуру БД Вконтакте по скриптам, приложеным в файле примеров `examples.sql`
2. Используя сервис <a href="http://filldb.info">http://filldb.info</a> или другой по вашему желанию, сгенерировать тестовые данные для всех таблиц, учитывая логику связей. Для всех таблиц, где это имеет смысл, создать не менее 100 строк. Загрузить тестовые данные. Приложить к отчёту полученный дамп с данными.
3. (по желанию) Проанализировать структуру БД vk, которую мы создали на занятии, и внести предложения по усовершенствованию (если такие идеи есть). Напишите пожалуйста, всё-ли понятно по структуре.

[Вернуться к Оглавлению](#Оглавление)
## 4\. Вебинар\. CRUD-операции
1. Повторить все действия по доработке структуры БД vk и данных.
2. Подобрать сервис который будет служить основой для вашей курсовой работы.
3. (по желанию) Предложить свою реализацию лайков и постов.

[Вернуться к Оглавлению](#Оглавление)
## 5\. Видеоурок\. Операторы, фильтрация, сортировка и ограничение\. Агрегация данных
### Тема «Операторы, фильтрация, сортировка и ограничение»
1. Пусть в таблице `users` поля `created_at` и `updated_at` оказались незаполненными. Заполните их текущими датой и временем.
2. Таблица `users` была неудачно спроектирована. Записи `created_at` и `updated_at` были заданы типом `VARCHAR` и в них долгое время помещались значения в формате 20.10.2017 8:10. Необходимо преобразовать поля к типу `DATETIME`, сохранив введённые ранее значения.
3. В таблице складских запасов `storehouses_products` в поле `value` могут встречаться самые разные цифры: 0, если товар закончился и выше нуля, если на складе имеются запасы. Необходимо отсортировать записи таким образом, чтобы они выводились в порядке увеличения значения `value`. Однако нулевые запасы должны выводиться в конце, после всех записей.
4. (по желанию) Из таблицы `users` необходимо извлечь пользователей, родившихся в августе и мае. Месяцы заданы в виде списка английских названий (may, august)
5. (по желанию) Из таблицы `catalogs` извлекаются записи при помощи запроса. `SELECT * FROM catalogs WHERE id IN (5, 1, 2);` Отсортируйте записи в порядке, заданном в списке `IN`.
### Тема «Агрегация данных»
1. Подсчитайте средний возраст пользователей в таблице `users`.
2. Подсчитайте количество дней рождения, которые приходятся на каждый из дней недели. Следует учесть, что необходимы дни недели текущего года, а не года рождения.
3. (по желанию) Подсчитайте произведение чисел в столбце таблицы.

[Вернуться к Оглавлению](#Оглавление)
## 6\. Вебинар\. Операторы, фильтрация, сортировка и ограничение\. Агрегация данных
Работаем с БД vk и тестовыми данными, которые вы сгенерировали ранее:
1. Создать и заполнить таблицы лайков и постов.
2. Создать все необходимые внешние ключи и диаграмму отношений.
3. Определить кто больше поставил лайков (всего) - мужчины или женщины?
4. Подсчитать общее количество лайков десяти самым молодым пользователям (сколько лайков получили 10 самых молодых пользователей).
5. Найти 10 пользователей, которые проявляют наименьшую активность в использовании социальной сети (критерии активности необходимо определить самостоятельно).

[Вернуться к Оглавлению](#Оглавление)
## 7\. Видеоурок\. Сложные запросы
1. Составьте список пользователей `users`, которые осуществили хотя бы один заказ `orders` в интернет магазине.
2. Выведите список товаров `products` и разделов `catalogs`, который соответствует товару.
3. (по желанию) Пусть имеется таблица рейсов `flights (id, from, to)` и таблица городов `cities (label, name)`. Поля `from`, `to` и `label` содержат английские названия городов, поле `name` — русское. Выведите список рейсов `flights` с русскими названиями городов.

[Вернуться к Оглавлению](#Оглавление)
## 8\. Вебинар\. Сложные запросы
Переписать запросы, заданые к ДЗ урока 6, с использованием `JOIN`

[Вернуться к Оглавлению](#Оглавление)
## 9\. Видеоурок\. Транзакции, переменные, представления\. Администрирование\. Хранимые процедуры и функции, триггеры
### Тема “Транзакции, переменные, представления”
1. В базе данных `shop` и `sample` присутствуют одни и те же таблицы, учебной базы данных. Переместите запись `id = 1` из таблицы `shop.users` в таблицу `sample.users`. Используйте транзакции.
2. Создайте представление, которое выводит название name товарной позиции из таблицы `products` и соответствующее название каталога name из таблицы `catalogs`.
3. (по желанию) Пусть имеется таблица с календарным полем `created_at`. В ней размещены разряженые календарные записи за август 2018 года '2018-08-01', '2016-08-04', '2018-08-16' и 2018-08-17. Составьте запрос, который выводит полный список дат за август, выставляя в соседнем поле значение 1, если дата присутствует в исходном таблице и 0, если она отсутствует.
4. (по желанию) Пусть имеется любая таблица с календарным полем `created_at`. Создайте запрос, который удаляет устаревшие записи из таблицы, оставляя только 5 самых свежих записей.

### Тема “Администрирование MySQL” (эта тема изучается по вашему желанию)
1. Создайте двух пользователей которые имеют доступ к базе данных `shop`. Первому пользователю `shop_read` должны быть доступны только запросы на чтение данных, второму пользователю `shop` — любые операции в пределах базы данных `shop`.
2. (по желанию) Пусть имеется таблица `accounts` содержащая три столбца `id`, `name`, `password`, содержащие первичный ключ, имя пользователя и его пароль. Создайте представление username таблицы `accounts`, предоставляющий доступ к столбца `id` и `name`. Создайте пользователя `user_read`, который бы не имел доступа к таблице `accounts`, однако, мог бы извлекать записи из представления `username`.

### Тема “Хранимые процедуры и функции, триггеры"
1. Создайте хранимую функцию `hello()`, которая будет возвращать приветствие, в зависимости от текущего времени суток. С 6:00 до 12:00 функция должна возвращать фразу "Доброе утро", с 12:00 до 18:00 функция должна возвращать фразу "Добрый день", с 18:00 до 00:00 — "Добрый вечер", с 00:00 до 6:00 — "Доброй ночи".
2. В таблице `products` есть два текстовых поля: `name` с названием товара и `description` с его описанием. Допустимо присутствие обоих полей или одно из них. Ситуация, когда оба поля принимают неопределенное значение `NULL` неприемлема. Используя триггеры, добейтесь того, чтобы одно из этих полей или оба поля были заполнены. При попытке присвоить полям NULL-значение необходимо отменить операцию.
3. (по желанию) Напишите хранимую функцию для вычисления произвольного числа Фибоначчи. Числами Фибоначчи называется последовательность в которой число равно сумме двух предыдущих чисел. Вызов функции `FIBONACCI(10)` должен возвращать число 55.

[Вернуться к Оглавлению](#Оглавление)
## 10\. Вебинар\. Транзакции, переменные, представления\. Администрирование\. Хранимые процедуры и функции, триггеры
Задания на БД vk:
1. Проанализировать какие запросы могут выполняться наиболее часто в процессе работы приложения и добавить необходимые индексы.
2. Задание на оконные функции. Построить запрос, который будет выводить следующие столбцы:
- имя группы;
- среднее количество пользователей в группах;
- самый молодой пользователь в группе;
- самый старший пользователь в группе;
- общее количество пользователей в группе;
- всего пользователей в системе;
- отношение в процентах (общее количество пользователей в группе / всего пользователей в системе) * 100.

[Вернуться к Оглавлению](#Оглавление)
## 11\. Видеоурок\. Оптимизация запросов\. NoSQL
### Тема “Оптимизация запросов”
1. Создайте таблицу `logs` типа `Archive`. Пусть при каждом создании записи в таблицах `users`, `catalogs` и `products` в таблицу `logs` помещается время и дата создания записи, название таблицы, идентификатор первичного ключа и содержимое поля `name`.
(по желанию) Создайте SQL-запрос, который помещает в таблицу `users` миллион записей.

### Тема “NoSQL”
1. В базе данных `Redis` подберите коллекцию для подсчета посещений с определенных IP-адресов.
2. При помощи базы данных `Redis` решите задачу поиска имени пользователя по электронному адресу и наоборот, поиск электронного адреса пользователя по его имени.
3. Организуйте хранение категорий и товарных позиций учебной базы данных `shop` в СУБД `MongoDB`.

[Вернуться к Оглавлению](#Оглавление)
## 12\. Вебинар\. Оптимизация запросов

[Вернуться к Оглавлению](#Оглавление)
